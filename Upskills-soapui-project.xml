<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="5f22628c-35e7-4847-8675-8e347302d578" activeEnvironment="Default" name="Upskills" resourceRoot="" soapui-version="5.6.0" abortOnError="false" runType="SEQUENTIAL" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:interface xsi:type="con:RestService" id="57c6984c-e14d-4322-83ae-0067372b6bda" wadlVersion="http://wadl.dev.java.net/2009/02" name="http://rest-api.upskills.in" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>http://rest-api.upskills.in</con:endpoint></con:endpoints><con:resource name="Client_credentials" path="/api/rest_admin/oauth2/token/client_credentials" id="6954710c-1793-4cab-b5e6-f20cc782a0cf"><con:settings/><con:parameters/><con:method name="Client_credentials 1" id="5f7a3734-5f4d-4f5c-98bb-6c7316e83497" method="POST"><con:settings/><con:parameters/><con:representation type="FAULT"><con:mediaType>application/json; charset=utf-8</con:mediaType><con:status>405</con:status><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json; charset=utf-8</con:mediaType><con:status>200</con:status><con:params/></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:request name="getaccesstoken" id="8aa0e530-8464-4c44-9a03-dd613b3718ae" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Basic dXBza2lsbHNfcmVzdF9hZG1pbl9vYXV0aF9jbGllbnQ6dXBza2lsbHNfcmVzdF9hZG1pbl9vYXV0aF9zZWNyZXQ=" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://rest-api.upskills.in</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="ea0a462d-6869-40e0-8f80-405d05425018" wadlVersion="http://wadl.dev.java.net/2009/02" name="http://rest-api.upskills.in" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>http://rest-api.upskills.in</con:endpoint></con:endpoints><con:resource name="Register" path="/api/rest/register" id="5722fefe-79d1-4b28-9ff8-e0d4ff3ad7a7"><con:settings/><con:parameters/><con:method name="Register 1" id="fb2c662e-2d60-4354-adbc-b432219e5228" method="POST"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json; charset=utf-8</con:mediaType><con:status>200</con:status><con:params/></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json; charset=utf-8</con:mediaType><con:status>400</con:status><con:params/></con:representation><con:request name="create customer" id="905e4e4c-dc93-48e4-92f0-bc38a1e5797b" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer 3e19172c24a44d8e7d0201f8b0dfa927abec3c14" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://rest-api.upskills.in</con:endpoint><con:request>{
  "firstname": "pooja",
  "lastname": "modani",
  "email": "poojamodani@gmail.com",
  "password": "password",
  "confirm": "password",
  "telephone": "1-541-754-3010",
  "customer_group_id": "1",
  "agree": "1",
  "custom_field": {
    "account": {
      "1": "+364545454"
    }
  }
}</con:request><con:originalUri>http://rest-api.upskills.in/api/rest/register</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="2d88b093-c3eb-4c18-9428-ba629f43ca20" wadlVersion="http://wadl.dev.java.net/2009/02" name="http://rest-api.upskills.in" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>http://rest-api.upskills.in</con:endpoint></con:endpoints><con:resource name="Login" path="/api/rest/login" id="8b0eeed6-031b-448b-b60e-912fb983a367"><con:settings/><con:parameters/><con:method name="Login 1" id="5d3ad321-e5d0-474a-837e-28aa515b5e87" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json; charset=utf-8</con:mediaType><con:status>400 403</con:status><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json; charset=utf-8</con:mediaType><con:status>200</con:status><con:params/></con:representation><con:request name="login customer" id="9620225a-3589-4c51-be48-d20722dd1fc1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer 3e19172c24a44d8e7d0201f8b0dfa927abec3c14" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://rest-api.upskills.in</con:endpoint><con:request>{
  "email": "poojamodani@gmail.com",
  "password": "password"
}</con:request><con:originalUri>http://rest-api.upskills.in/api/rest/login</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="460e1349-db57-423e-b4fa-7e3c520e3354" wadlVersion="http://wadl.dev.java.net/2009/02" name="http://rest-api.upskills.in" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>http://rest-api.upskills.in</con:endpoint></con:endpoints><con:resource name="Account" path="/api/rest/account" id="550a8764-5319-4da7-901f-81aca4139e7b"><con:settings/><con:parameters/><con:method name="Account 1" id="3ab1390c-d58b-415f-bdb1-8f21d0effc2a" method="GET"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json; charset=utf-8</con:mediaType><con:status>200</con:status><con:params/></con:representation><con:request name="account details" id="5c983ff5-3032-43df-8065-186d26f74071" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer 3e19172c24a44d8e7d0201f8b0dfa927abec3c14" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://rest-api.upskills.in</con:endpoint><con:request/><con:originalUri>http://rest-api.upskills.in/api/rest/account</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="dccc9c39-d1b8-4145-8a1a-06ef4a6a9101" wadlVersion="http://wadl.dev.java.net/2009/02" name="http://rest-api.upskills.in" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>http://rest-api.upskills.in</con:endpoint></con:endpoints><con:resource name="Logout" path="/api/rest/logout" id="ef800418-6b64-420e-82af-779430f7dfdd"><con:settings/><con:parameters/><con:method name="Logout 1" id="a0c89201-7100-4f18-93d5-31d6dda3d836" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json; charset=utf-8</con:mediaType><con:status>200</con:status><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json; charset=utf-8</con:mediaType><con:status>401 400</con:status><con:params/></con:representation><con:request name="logout customer" id="30e1acd4-2d9a-4f7f-a377-d825630062f9" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer 3e19172c24a44d8e7d0201f8b0dfa927abec3c14" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://rest-api.upskills.in</con:endpoint><con:request/><con:originalUri>http://rest-api.upskills.in/api/rest/logout</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="40b97a91-8055-4568-99de-f0b8ac059326" wadlVersion="http://wadl.dev.java.net/2009/02" name="http://rest-api.upskills.in" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>http://rest-api.upskills.in</con:endpoint></con:endpoints><con:resource name="Password" path="/api/rest/account/password" id="26c7a2c8-8b95-4487-b9f1-d93c79feaaaf"><con:settings/><con:parameters/><con:method name="Password 1" id="c3d40eab-86e0-42fa-9756-bb420dcf604c" method="PUT"><con:settings/><con:parameters/><con:representation type="FAULT"><con:mediaType>application/json; charset=utf-8</con:mediaType><con:status>403 400</con:status><con:params/></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json; charset=utf-8</con:mediaType><con:status>200</con:status><con:params/></con:representation><con:request name="change password" id="83a77c53-5964-4929-acad-a2d97582f302" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer 3e19172c24a44d8e7d0201f8b0dfa927abec3c14" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://rest-api.upskills.in</con:endpoint><con:request>{
  "password": "password",
  "confirm": "password"
}</con:request><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:testSuite id="b4994ced-27bb-4997-95e4-ea6a8aaa2921" name="TestSuite"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="2dfbf5b5-692e-4648-8057-ddeb3bca9714" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Testcase 1" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="getaccesstoken" id="0ae95072-e866-4119-9030-b09e3b99e8f9"><con:settings/><con:config service="http://rest-api.upskills.in" resourcePath="/api/rest_admin/oauth2/token/client_credentials" methodName="Client_credentials 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="getaccesstoken" id="8aa0e530-8464-4c44-9a03-dd613b3718ae" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Basic ZGVtb19vYXV0aF9jbGllbnQ6ZGVtb19vYXV0aF9zZWNyZXQ" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://rest-api.upskills.in</con:endpoint><con:request/><con:originalUri>http://rest-api.upskills.in/api/rest_admin/oauth2/token/client_credentials</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="108fad4f-a6bc-47bc-be81-b08607d490e5" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" id="fc7666dc-bb2a-4fd3-a1c1-32deb0988d2d" name="Script Assertion"><con:configuration><scriptText>def res = messageExchange.response.responseContent
def token = res.substring(48,88)
context.testCase.setPropertyValue("token",token)</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="8f8cc686-1ff5-4ed9-a6ff-eed9aa012616"><con:settings/><con:config><script>import jxl.* // import Java Excel API library
def TestCase = context.testCase
def FilePath = "C:/Users/user/Downloads/testdatafortask.xls"
def count
Workbook WorkBook1 = Workbook.getWorkbook(new File(FilePath))
Sheet Sheet1 = WorkBook1.getSheet(0)
PropertiesTestStep = TestCase.getTestStepByName("Properties")
count = PropertiesTestStep.getPropertyValue("Counter").toInteger()
//If Total records is unknown (at start), get the rowcount from Excel
if (PropertiesTestStep.getPropertyValue("Total").toString() == "")
    PropertiesTestStep.setPropertyValue("Total", Sheet1.getRows().toString())
count++
//Read the Excel test data
Cell Field1 = Sheet1.getCell(0, count)
Cell Field2 = Sheet1.getCell(1, count)
Cell Field3 = Sheet1.getCell(2, count)
Cell Field4 = Sheet1.getCell(3, count)
log.info ("Count is " + count.toString() + " email : " + Field1.getContents() + " lastname : " + Field2.getContents()+ " firstname : " + Field3.getContents()+ " password : " + Field4.getContents())
WorkBook1.close()
//Copy the Excel test data to properties in Properties test step
PropertiesTestStep.setPropertyValue("email", Field1.getContents())
PropertiesTestStep.setPropertyValue("lastname", Field2.getContents())
PropertiesTestStep.setPropertyValue("firstname", Field3.getContents())
PropertiesTestStep.setPropertyValue("password", Field4.getContents())
PropertiesTestStep.setPropertyValue("Counter", count.toString())
if (count == PropertiesTestStep.getPropertyValue("Total").toInteger() - 1)
    PropertiesTestStep.setPropertyValue("End", "True")

</script></con:config></con:testStep><con:testStep type="properties" name="Properties" id="7eb56a03-5350-4189-966e-56209da351c8"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>email</con:name><con:value>gdfwvtecv@gmail.com</con:value></con:property><con:property><con:name>Counter</con:name><con:value>1</con:value></con:property><con:property><con:name>Total</con:name><con:value>4</con:value></con:property><con:property><con:name>End</con:name><con:value>False</con:value></con:property><con:property><con:name>lastname</con:name><con:value>pleasee</con:value></con:property><con:property><con:name>firstname</con:name><con:value>saveeee</con:value></con:property><con:property><con:name>password</con:name><con:value>passwordd</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="restrequest" name="create customer" id="e18c6074-1db0-4972-82b0-2f0912925a11"><con:settings/><con:config service="http://rest-api.upskills.in" resourcePath="/api/rest/register" methodName="Register 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="create customer" id="905e4e4c-dc93-48e4-92f0-bc38a1e5797b" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer ${#TestCase#token}" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://rest-api.upskills.in</con:endpoint><con:request>{
  "firstname": "${Properties#firstname}",
  "lastname": "${Properties#lastname}",
  "email": "${Properties#email}",
  
  "password": "password",
  "confirm": "password",
  "telephone": "1-541-754-3010",
  "customer_group_id": "1",
  "agree": "1",
  "custom_field": {
    "account": {
      "1": "+364545454"
    }
  }
}</con:request><con:originalUri>http://rest-api.upskills.in/api/rest/register</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="9c5fb1e8-30db-4df1-aebd-f42a546c1de8" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="logout customer" id="764a939d-d556-44e4-a341-54781a7fcd2a"><con:settings/><con:config service="http://rest-api.upskills.in" resourcePath="/api/rest/logout" methodName="Logout 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="logout customer" id="30e1acd4-2d9a-4f7f-a377-d825630062f9" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer ${#TestCase#token}" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://rest-api.upskills.in</con:endpoint><con:request/><con:originalUri>http://rest-api.upskills.in/api/rest/logout</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="155c0981-eaf6-4f81-a639-8b30bb7b4d3f" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="login customer" id="78cf5c64-404d-4e5f-986a-63b462f29312"><con:settings/><con:config service="http://rest-api.upskills.in" resourcePath="/api/rest/login" methodName="Login 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="login customer" id="9620225a-3589-4c51-be48-d20722dd1fc1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer ${#TestCase#token}" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://rest-api.upskills.in</con:endpoint><con:request>{
  "email": "${Properties#email}",
  "password": "password"
}</con:request><con:originalUri>http://rest-api.upskills.in/api/rest/login</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="b16825f4-40ee-46d1-ab47-12c9e90a9297" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="account details" id="b9e7155c-b57a-400e-8313-77094b8a390e"><con:settings/><con:config service="http://rest-api.upskills.in" resourcePath="/api/rest/account" methodName="Account 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="account details" id="5c983ff5-3032-43df-8065-186d26f74071" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer ${#TestCase#token}" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://rest-api.upskills.in</con:endpoint><con:request/><con:originalUri>http://rest-api.upskills.in/api/rest/account</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="fa2a44d4-a480-46e6-9b51-fc6a3c12dfb2" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="Groovy script-CleanUp" id="e97a734b-0ae5-4f66-9fb9-47ff42c264da" disabled="true"><con:settings/><con:config><script>def TestCase = context.testCase
PropertiesTestStep = TestCase.getTestStepByName("Properties")
PropertiesTestStep.setPropertyValue("email","")
PropertiesTestStep.setPropertyValue("lastname", "")
PropertiesTestStep.setPropertyValue("firstname", "")
PropertiesTestStep.setPropertyValue("password", "")
PropertiesTestStep.setPropertyValue("Counter", "0")
PropertiesTestStep.setPropertyValue("Total", "")
PropertiesTestStep.setPropertyValue("End", "False")</script></con:config></con:testStep><con:properties><con:property><con:name>token</con:name><con:value>44a3b3c71a5724700ef2b49812e632431f561a38</con:value></con:property></con:properties></con:testCase><con:testCase id="1715bdd9-cb44-4023-b543-e24689e361d9" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 5" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="getaccesstoken" id="d8554bc2-8909-40ee-b063-7f8514ac82ec"><con:settings/><con:config service="http://rest-api.upskills.in" resourcePath="/api/rest_admin/oauth2/token/client_credentials" methodName="Client_credentials 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="getaccesstoken" id="8aa0e530-8464-4c44-9a03-dd613b3718ae" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Basic c2hvcHBpbmdfb2F1dGhfY2xpZW50OnNob3BwaW5nX29hdXRoX3NlY3JldA==" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://rest-api.upskills.in</con:endpoint><con:request/><con:originalUri>http://rest-api.upskills.in/api/rest_admin/oauth2/token/client_credentials</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="108fad4f-a6bc-47bc-be81-b08607d490e5" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" id="fc7666dc-bb2a-4fd3-a1c1-32deb0988d2d" name="Script Assertion"><con:configuration><scriptText>def res = messageExchange.response.responseContent
def token = res.substring(48,88)
context.testCase.setPropertyValue("token",token)
log.info token</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="f30bc134-dc7e-4995-9c5a-8b8e7fb1a60c"><con:settings/><con:config><script>import jxl.* // import Java Excel API library
def TestCase = context.testCase
def FilePath = "C:/Users/user/Downloads/testdatafortask.xls"
def count
Workbook WorkBook1 = Workbook.getWorkbook(new File(FilePath))
Sheet Sheet1 = WorkBook1.getSheet(0)
PropertiesTestStep = TestCase.getTestStepByName("Properties")
count = PropertiesTestStep.getPropertyValue("Counter").toInteger()
//If Total records is unknown (at start), get the rowcount from Excel
if (PropertiesTestStep.getPropertyValue("Total").toString() == "")
    PropertiesTestStep.setPropertyValue("Total", Sheet1.getRows().toString())
count++
//Read the Excel test data
Cell Field1 = Sheet1.getCell(0, count)
Cell Field4 = Sheet1.getCell(3, count)
log.info ("Count is " + count.toString() + " email : " + Field1.getContents() + " password : " + Field4.getContents())
WorkBook1.close()
//Copy the Excel test data to properties in Properties test step
PropertiesTestStep.setPropertyValue("email", Field1.getContents())
PropertiesTestStep.setPropertyValue("password", Field4.getContents())
PropertiesTestStep.setPropertyValue("Counter", count.toString())
if (count == PropertiesTestStep.getPropertyValue("Total").toInteger() - 1)
    PropertiesTestStep.setPropertyValue("End", "True")









</script></con:config></con:testStep><con:testStep type="properties" name="Properties" id="f17bd694-8c46-486f-9304-1cdd52f87a0d"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>email</con:name><con:value/></con:property><con:property><con:name>Counter</con:name><con:value>0</con:value></con:property><con:property><con:name>Total</con:name><con:value/></con:property><con:property><con:name>End</con:name><con:value>False</con:value></con:property><con:property><con:name>lastname</con:name><con:value/></con:property><con:property><con:name>firstname</con:name><con:value/></con:property><con:property><con:name>password</con:name><con:value/></con:property></con:properties></con:config></con:testStep><con:testStep type="restrequest" name="login" id="bc9b314a-3372-40ff-89ac-19c774e573ba"><con:settings/><con:config service="http://rest-api.upskills.in" resourcePath="/api/rest/login" methodName="Login 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="login" id="9620225a-3589-4c51-be48-d20722dd1fc1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer ${#TestCase#token}" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://rest-api.upskills.in</con:endpoint><con:request>{
  "email": "${Properties#email}",
  "password": "${Properties#password}"
}</con:request><con:originalUri>http://rest-api.upskills.in/api/rest/login</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="2edabf1c-68bf-4656-bef5-70eb67050683" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" id="91911210-edab-44d0-9455-42c1f92d53f3" name="Script Assertion"><con:configuration><scriptText>def res = messageExchange.response.responseContent
def customer_id = res.substring(48,88)
context.testCase.setPropertyValue("customer_id",customer_id)
log.info customer_id</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="change password" id="7c4cc125-1c3d-422a-9f84-2dbe5d4ea5e0"><con:settings/><con:config service="http://rest-api.upskills.in" resourcePath="/api/rest/account/password" methodName="Password 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="change password" id="83a77c53-5964-4929-acad-a2d97582f302" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer ${#TestCase#token}" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://rest-api.upskills.in</con:endpoint><con:request>{
  "password": "demo1",
  "confirm": "demo1"
}</con:request><con:originalUri>http://rest-api.upskills.in/api/rest/account/password</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="6d79693c-6f48-4923-a1f4-dc0c8d3e6d09" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="logout customer" id="0ddb4f62-2eb7-4e5f-8fd6-2d66391fe0dd"><con:settings/><con:config service="http://rest-api.upskills.in" resourcePath="/api/rest/logout" methodName="Logout 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="logout customer" id="30e1acd4-2d9a-4f7f-a377-d825630062f9" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer ${#TestCase#token}" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://rest-api.upskills.in</con:endpoint><con:request/><con:originalUri>http://rest-api.upskills.in/api/rest/logout</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="155c0981-eaf6-4f81-a639-8b30bb7b4d3f" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties><con:property><con:name>token</con:name><con:value>3199ed0059354c81093c899a97fba711fa9b0326</con:value></con:property><con:property><con:name>customer_id</con:name><con:value>ail Address and\/or Password."],"data":[</con:value></con:property></con:properties></con:testCase><con:properties/></con:testSuite><con:properties/><con:wssContainer/><con:oAuth2ProfileContainer/><con:oAuth1ProfileContainer/><con:sensitiveInformation/></con:soapui-project>